<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<div class="custom-toolbar">
    <button kendoButton icon="menu" look="flat" (click)="drawer.toggle()"></button>
    <span class="mail-box">Bienvenido(a) {{ student.studentName}} {{ student.lastName}}</span>
</div>
<kendo-drawer-container>
    <kendo-drawer #drawer class="drawer" [items]="items" [mode]="'push'" [mini]="true" [expanded]="true"
        (select)="onSelect($event)"></kendo-drawer>

    <div class="container">
        <!-- <kendo-drawer-content> -->
            <!-- <kendo-drawer-content class="pre-scrollable"></kendo-drawer-content> -->
            <div *ngIf="selected === 'Perfil'">
                <h3>Datos personales</h3>
                <h4>Carné: {{ student.studentCard }}</h4>
                <h4>Nombre de usuario: {{ student.username }}</h4>
                <h4>Correo electrónico: {{ student.mail }}</h4>
                <h4>Fecha de nacimiento: {{ student.birthday }}</h4>
                <hr style="width:75%;" style="border-color:rgb(109, 166, 241);" />
                <h3>Ubicación</h3>
                <h4>Provincia: {{ student.province }}</h4>
                <h4>Cantón: {{ student.canton }}</h4>
                <h4>Distrito: {{ student.district }}</h4>

                <button mat-button (click)="editProfile()">Editar perfil</button>

                <kendo-upload [saveUrl]="uploadSaveUrl" [removeUrl]="uploadRemoveUrl">
                </kendo-upload>
            </div>

            <div *ngIf="selected === 'Noticias'">
                <kendo-scrollview #sv [data]="itemsNews" [width]="width" [height]="height" [animate]="true"
                    [arrows]="true" [pageable]="true" [endless]="true">
                    <ng-template let-item="item">
                        <h2 class="scroll-view-title">
                            {{item.title}}
                            <br>
                            <br>
                            <br>
                            Noticia: {{item.text}}
                            <br>
                            Autor: {{item.authorName}}
                            <br>
                            Fecha publicación: {{item.dateTime}}
                            <br>
                            <button mat-button (click)="getComments(item.id)">Ver comentarios</button>
                        </h2>
                        <img src='./assets/firma-horizontal-dos-lineas-cmky2.png' draggable="false" />
                    </ng-template>
                </kendo-scrollview>
                <mat-list>
                    <div mat-subheader>Comentarios para noticia: {{currentNewsName}}</div>
                    <mat-list-item *ngFor="let comment of comments">
                        <mat-icon mat-list-icon>comment</mat-icon>
                        <div mat-line>{{comment.authorName}}: {{comment.text}}</div>
                        <div mat-line> {{comment.dateTime | date}} </div>
                    </mat-list-item>
                    <mat-divider></mat-divider>
                    <div mat-subheader></div>
                    <mat-form-field style="width:400px">
                        <textarea matInput type="text" placeholder="Nuevo comentario..."
                            [(ngModel)]="commentData.comment" name="comment"></textarea>
                    </mat-form-field>
                    <button mat-button (click)="addComment()">
                        <mat-icon mat-list-icon>send</mat-icon>
                    </button>
                </mat-list>
            </div>

            <div *ngIf="selected === 'Cursos'">
                <div class="mat-elevation-z8">
                    <table mat-table [dataSource]="dataSourceCourses">

                        <ng-container matColumnDef="initials">
                            <th mat-header-cell *matHeaderCellDef> Siglas </th>
                            <td mat-cell *matCellDef="let course"> {{course.initials}} </td>
                        </ng-container>

                        <ng-container matColumnDef="courseName">
                            <th mat-header-cell *matHeaderCellDef> Nombre </th>
                            <td mat-cell *matCellDef="let course"> {{course.courseName}} </td>
                        </ng-container>

                        <ng-container matColumnDef="credits">
                            <th mat-header-cell *matHeaderCellDef> Créditos </th>
                            <td mat-cell *matCellDef="let course"> {{course.credits}} </td>
                        </ng-container>

                        <ng-container matColumnDef="professor_name">
                            <th mat-header-cell *matHeaderCellDef> Profesor </th>
                            <td mat-cell *matCellDef="let course"> {{course.professor_name}} </td>
                        </ng-container>

                        <tr mat-header-row *matHeaderRowDef="courseColumns"></tr>
                        <tr mat-row *matRowDef="let row; columns: courseColumns;"></tr>

                    </table>
                    <mat-paginator #firstTable [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons></mat-paginator>
                </div>
            </div>

            <div id="publicConsultUl" *ngIf="selected === 'Consulta pública'">
                <h3 id="subtitle">Consulta Pública</h3>
                <div class="row ">
                    <div class="col-md-6 pre-scrollable">
                        <ul>
                            <li *ngFor="let p of publicConsultation">
                                <h5> Consulta: {{ p.motive }}
                                    <button class="pull-right" kendoButton [icon]="'preview'" (click)="showRepliesPublicConsultation(p.id)"
                                        (click)="getCourseById(p.course_id)"></button>
                                </h5>
                                Fecha: {{ p.dateTime | date }}
                            </li>
                        </ul>

                        <hr style="width:75%;" style="border-color:rgb(109, 166, 241);" />

                        <div class="repliesPublicConsultation" *ngIf="show === true">
                            <h4>Respuestas</h4>
                            <h5>Curso: {{ course.name }}</h5>
                            <ul>
                                <li *ngFor="let r of repliesPublicConsultation">
                                    <h5> {{ r.motive }} </h5>
                                    Fecha: {{ r.dateTime | date }}
                                </li>
                            </ul>
                            <form [formGroup]="repliesPublicConsultationForm"
                                (ngSubmit)="addRepliesPublicConsultation(currentPublicConsultation)" #formDir="ngForm">
                                <div class="col-md-4">
                                    <h4>Añadir respuesta</h4>
                                    
                                    <textarea name="repliesPublicConsultation" formControlName="repliesForm"
                                        class="form-control" type="text" autocomplete="off" size="20"></textarea>
                                
                                    <br>
                                    <button mat-raised-button id="btnSendResponse" type="submit">Enviar</button>
                                    <span class="text-danger"
                                        *ngIf="repliesPublicConsultationForm.hasError('required', 'repliesForm') && formDir.submitted">
                                        Debe escribir una respuesta.
                                    </span>
                                </div>
                            </form>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <h4 id="subtitle">Enviar nueva consulta</h4>
                        <form [formGroup]="publicConsultationForm" (ngSubmit)="addPublicConsultation()"
                            #formDir="ngForm">
                            <label class="control-label">Consulta:</label>
                            <input name="publicConsultation" formControlName="addPublicConsultationForm"
                                class="form-control" type="text" autocomplete="off" size="10">
                            <br>
                            <label class="control-label">Curso: </label>
                            <kendo-dropdownlist [data]="courses" [valueField]="'course_id'" [textField]="'courseName'"
                                [defaultItem]="defaultItemCourse" (valueChange)="courseChange($event)"
                                [value]="selectedCourse">
                            </kendo-dropdownlist>
                            <br>
                            <br>
                            <button class="pull-right" mat-raised-button id="btnSendConsultation" type="submit">Enviar</button>
                            <span class="text-danger"
                                *ngIf="publicConsultationForm.hasError('required', 'addPublicConsultationForm') && formDir.submitted">
                                Debe escribir una consulta.
                            </span>
                        </form>
                    </div>
                </div>
            </div>

            <div *ngIf="selected === 'Consulta privada'">

            </div>

            <div *ngIf="selected === 'Citas de atención'">
            </div>
        <!-- </kendo-drawer-content> -->
    </div>
</kendo-drawer-container>